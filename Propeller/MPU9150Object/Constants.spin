CON        _clkmode = xtal1 + pll16x                                               'Standard clock mode * crystal frequency = 80 MHz        _xinfreq = 5_000_000CON'Enum statesnominal = 0WP_getlist = 3WP_sendlist = 1WP_clearlist = 5WP_setcurrent = 6Timeout_max = 5000 '5 seconds (ms)array_length = 128 CON'------------------------------------------------------------------''PROP A PINS'------------------------------------------------------------------        'LED's on prop ACTS_2_A            = 0DIN_A              = 1DOUT_A             = 2LED0_A             = 17LED1_A             = 18LED2_A             = 19LED3_A             = 20'PING SENSORPW                 = 9'GPSTX_GPS             = 4RX_GPS             = 3'ANALOG I2CE_SCL_A            = 27E_SDA_A            = 26AIR_SDA            = 5AIR_SCL            = 6'GYRO/ACCELEROMETER SPICS3_G              = 16CS_A               = 15CS2_G              = 14MISO               = 13CS1_G              = 12SCK                = 11MOSI               = 10'INTERPROP COMMPROP_COM3_A        = 21PROP_COM2_A        = 22PROP_COM1_A        = 23'PROP HUB ASCL_EPP_A          = 28SDA_EPP_A          = 29TXPP_A             = 30RXPP_A             = 31'Free pinstimerpin           = 25timerpin_2         = 24'------------------------------------------------------------------''PROP B PINS'------------------------------------------------------------------SD_SWITCH          = 27SD_DO              = 0SD_CLK             = 1SD_DI              = 2SD_CS              = 3PC4                = 26'PROP B LED'sLED1_B             = 4LED2_B             = 5LED3_B             = 6LED4_B             = 7LED5_B             = 11LED6_B             = 12LED7_B             = 13'INTERPROP COMMPROP_COM1_B        = 8PROP_COM2_B        = 9PROP_COM3_B        = 10'XBEE PORTDIN_B              = 24DOUT_B             = 25'SERVO PORTSRX_IN              = 22RSSI_IN            = 23SERVO_8            = 14SERVO_7            = 15SERVO_6            = 16SERVO_5            = 17SERVO_4            = 18SERVO_3            = 19SERVO_2            = 20SERVO_1            = 21'PROP HUB BSCL_EPP_B          = 28SDA_EPP_B          = 29RXPP_B             = 30TXPP_B             = 31CON'Program constants'----------------------  scale = 30  scale_mag = 1<<scale  scale_mag_float = float(scale_mag)   'i2cAddresses'----------------------  AKM_address                   = %0001_1000   HMC_address                   = %0011_1100  MPX_address                   = %0101_0000  ADC_address                   = %0110_1000  MPU_address                   = %1101_0000  BMP_address                   = %1110_1110  PCA_address                   = %1111_1110'SCC1300_D04'----------------------  Sample_frequency = 3050.0  MPU_Sample_frequency = 40.0  'SCALE_GYRO = 133264570(round(1.0*300.0/5400.0*pi/180.0*float(1<<scale)/Sample_frequency))  SCALE_GYRO_CMS = round(1.0/204.8*pi/180.0/Sample_frequency*float(1<<30))          'CMS Gyros  SCALE_GYRO_MPU = round(1.0/65.5*pi/180.0/dt_float*float(1<<30))  SCALE_GYRO_LOW = 620338431                                                    'remainder of above scale factor   SCALE_ACCEL = (round(1000.0*9.807/Sample_frequency*1024.0))                   'Scaled by 1024 for bit shift  SCALE_ACCEL_MPU = (round(1000.0*9.807/dt_float*1024.0*12800.0/4096.0))  CMS_max = round(145.0*204.8*Sample_frequency/dt_float)  high_accel = round(2.5*12800.0*Sample_frequency/dt_float*0.95)                    'Within 95% of sensor range, switch to low gain accelerometer  Angle_update_frequency = round(Sample_frequency/float(dt))  g_earth = 9807  M_MAG = 820'Timing and integration constants'----------------------  dt = 122  dt_float = float(dt)  dt_GPS = 4  zero_count = 2048  'Sensor scaling'----------------------  S_SCALE = 15  Accel_scale = 12800' Data writing constants'----------------------  PROP_A_TX_COUNT = 90  PROP_A_RX_COUNT = 30  PROP_B_TX_COUNT = PROP_A_RX_COUNT  PROP_B_RX_COUNT = PROP_A_TX_COUNT  DATA_LENGTH = 5'Eeprom base address for waypoints'----------------------  Eeprom_base_address = 32769  Eeprom_home_address = 32769*14*4*256  CON  'Aircraft constants'----------------------roll_max = 500pitch_max = 500yaw_max = 500hold_loiter_radius = 300 'In m, +clockwiseCON'Port declarationspcport          = 0pcrx            = 31pctx            = 30pcbaud          = 115200xbeeport        = 1 xbeetx          = DOUT_Bxbeerx          = DIN_Bxbeebaud        = 57600GPSport         = 2GPSrx           = 3GPStx           = 4GPSBaud         = 57600XTendport       = 3XTendtx         = 2XTendrx         = 1XTendbaud       = 57600CONMAV_STATE_UNINIT                = 0                     'Uninitialized system, state is unknown.MAV_STATE_BOOT                  = 1                     'System is booting up.MAV_STATE_CALIBRATING           = 2                     'System is calibrating and not flight-ready.MAV_STATE_STANDBY               = 3                     'System is grounded and on standby. It can be launched any time.MAV_STATE_ACTIVE                = 4                     'System is active and might be already airborne. Motors are engaged.MAV_STATE_CRITICAL              = 5                     'System is in a non-normal flight mode. It can however still navigate.MAV_STATE_EMERGENCY             = 6                     'System is in a non-normal flight mode. It lost control over parts or over the whole airframe. It is in mayday and going down.MAV_STATE_POWEROFF              = 7                     'System just initialized its power-down sequence, will shut down now.CONMAV_COMP_ID_ALL                 = 1 MAV_COMP_ID_GPS                 = 220 MAV_COMP_ID_MISSIONPLANNER      = 190      MAV_COMP_ID_PATHPLANNER         = 195      MAV_COMP_ID_MAPPER              = 180           MAV_COMP_ID_CAMERA              = 100           MAV_COMP_ID_IMU                 = 200      MAV_COMP_ID_IMU_2               = 201            MAV_COMP_ID_IMU_3               = 202            MAV_COMP_ID_UDP_BRIDGE          = 240       MAV_COMP_ID_UART_BRIDGE         = 241      MAV_COMP_ID_SYSTEM_CONTROL      = 250           MAV_COMP_ID_SERVO1              = 140           MAV_COMP_ID_SERVO2              = 141           MAV_COMP_ID_SERVO3              = 142           MAV_COMP_ID_SERVO4              = 143           MAV_COMP_ID_SERVO5              = 144           MAV_COMP_ID_SERVO6              = 145           MAV_COMP_ID_SERVO7              = 146           MAV_COMP_ID_SERVO8              = 147           MAV_COMP_ID_SERVO9              = 148           MAV_COMP_ID_SERVO10             = 149          MAV_COMP_ID_SERVO11             = 150          MAV_COMP_ID_SERVO12             = 151          MAV_COMP_ID_SERVO13             = 152          MAV_COMP_ID_SERVO14             = 153     GS_SYSTEM_ID                    = $FFTARGET_SYSTEM_ID                = 0CONSENSOR_GYRO                     = 0 '3D gyroSENSOR_ACCEL                    = 1 '3D accelerometerSENSOR_MAG                      = 2 '3D magnetometerSENSOR_ABSOLUTE_PRESSURE        = 3 'absolute pressureSENSOR_DIFFERENTIAL_PRESSURE    = 4 'differential pressureSENSOR_GPS                      = 5 'GPSSENSOR_OPTICAL_FLOW             = 6 'optical flowSENSOR_VISION_POSITION          = 7 'computer vision positionSENSOR_LASER_POSITION           = 8 'laser based positionSENSOR_EXTERNAL_GROUND_TRUTH    = 9 'external ground truth (Vicon or Leica)SENSOR_ANGULAR_RATE_CONTROL     = 10 '3D angular rate controlSENSOR_ATTITUDE_STABILIZATION   = 11 'attitude stabilizationSENSOR_YAW_POSITION             = 12 'yaw positionSENSOR_Z_ALTITUDE_CONTROL       = 13 'z/altitude controlSENSOR_XY_POSITION_CONTROL      = 14 'x/y position controlSENSOR_MOTOR_OUTPUTS            = 15 'motor outputs / controlSENSOR_RC_RECEIVER              = 16 'rc receiverSENSOR_3D_GYRO2                 = 17 '2nd 3D gyroSENSOR_3D_ACCEL2                = 18 '2nd 3D accelerometerSENSOR_3D_MAG2                  = 19 '2nd 3D magnetometer'Propeller specificSENSOR_RADIO_ON                 = 20 'Radio linkSENSOR_PROP_COM                 = 21 'Propeller intercommunication flagsensors_on_board = 1<<0|1<<1|1<<2|1<<3|1<<4|1<<5|1<<10|1<<11|1<<12|1<<13|1<<14|1<<16|1<<17|1<<18|1<<19PUB Main